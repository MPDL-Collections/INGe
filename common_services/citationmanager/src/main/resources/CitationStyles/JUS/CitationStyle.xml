<?xml version="1.0" encoding="UTF-8"?>
	<!--
		CDDL HEADER START The contents of this file are subject to the terms
		of the Common Development and Distribution License, Version 1.0 only
		(the "License"). You may not use this file except in compliance with
		the License. You can obtain a copy of the license at
		license/ESCIDOC.LICENSE or http://www.escidoc.de/license. See the
		License for the specific language governing permissions and
		limitations under the License. When distributing Covered Code, include
		this CDDL HEADER in each file and include the License file at
		license/ESCIDOC.LICENSE. If applicable, add the following below this
		CDDL HEADER, with the fields enclosed by brackets "[]" replaced with
		your own identifying information: Portions Copyright [yyyy] [name of
		copyright owner] CDDL HEADER END Copyright 2006-2007
		Fachinformationszentrum Karlsruhe Gesellschaft für
		wissenschaftlich-technische Information mbH and Max-Planck-
		Gesellschaft zur Förderung der Wissenschaft e.V. All rights reserved.
		Use is subject to license terms.
	-->
	<!--
		Specifications:
		http://colab.mpdl.mpg.de/mediawiki/http://colab.mpdl.mpg.de/mediawiki/JusCMS_Func_pec_Legal_Citation_Styles_HH_%26_Muc
	-->
<citation-style name="JUS"
	xmlns="http://www.escidoc.de/citationstyle" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.escidoc.de/citationstyle ../../Schemas/citation-style.xsd"
	read-only="no" element-specific="no" md-xpath="../../mdr:md-records/mdr:md-record"
	source-placeholder-tag="prop:content-model-specific"
	citation-placeholder-tag="dcterms:bibliographicCitation"
	include-default-variables="yes" include-global-default-variables="yes">

	<!-- predefined layout elements which can be referenced in CSLDs -->
	<predefined-layout-elements>

		<!--
			First Creator of the publication. If the creator is organization,
			that organization's name will be taken. If the creator has a role
			editor. a postfix 'ed.'is added. An Italic Font style is added for
			the first creator.
		-->
		<layout-element name="first-creator">
			<elements>
				<layout-element>
					<parameters>
						<delimiter value=", " />
						<font-style ref="ITALIC" />
					</parameters>
					<elements>
						<layout-element
							ref="pub:publication/e:creator[1]/person:person/e:family-name/text()" />
						<layout-element
							ref="pub:publication/e:creator[1]/person:person/e:given-name/text()" />
						<!-- if organization is given as creator, get the organization name -->
						<layout-element
							ref="pub:publication/e:creator[1]/organization:organization/dc:title/text()" />
					</elements>
				</layout-element>
				<!--
					if the role of the editor is creator, put postfix ed. behind his
					name
				-->
				<layout-element>
					<parameters>
						<valid-if><![CDATA[pub:publication/e:creator[1][@role=$l_editor] and 
						($genre != $l_article)]]></valid-if>
						<starts-with value="(" />
						<ends-with value=")" />
					</parameters>
					<elements>
						<layout-element>
							<parameters>
								<i18n ref="editor" />
							</parameters>
							<elements>
								<layout-element ref="$editor-postfix" />
							</elements>
						</layout-element>
					</elements>
				</layout-element>
			</elements>
		</layout-element>

		<!--
			Second or more creators are added at the end of the citation style.
			The creators are set in brackets. Before the creator names a
			'together with' postfix is added. The role of the creators does not
			matter. If the creator is organization, that organization's name will
			be taken. If the total number of creators is two or three, the second
			and the third creator's names is written at the end of the citation
			style. If there are more then three creators, only the second name
			will is written and a 'et. all' postfix is set.
		-->
		<layout-element name="second-or-more-creators">
			<parameters>
				<valid-if><![CDATA[$creatorsCount>1]]></valid-if>
				<starts-with value="(" />
				<ends-with value=")" />
			</parameters>
			<elements>
				<!-- span class together with prefix -->
				<layout-element>
					<parameters>
						<i18n ref="togetherWith" />
					</parameters>
					<elements>
						<layout-element ref="$together-prefix" />
					</elements>
				</layout-element>
				<!-- second author or editor -->
				<layout-element>
					<elements>
						<layout-element
							ref="pub:publication/e:creator[2]/person:person/e:given-name/text()" />
						<layout-element
							ref="pub:publication/e:creator[2]/person:person/e:family-name/text()" />
						<!-- if organization is given as creator, get the organization name -->
						<layout-element
							ref="pub:publication/e:creator[2]/organization:organization/dc:title/text()" />
					</elements>
				</layout-element>
				<!-- third author or editor -->
				<layout-element>
					<parameters>
						<valid-if><![CDATA[$creatorsCount<4]]></valid-if>
						<starts-with value=", " />
					</parameters>
					<elements>
						<layout-element
							ref="pub:publication/e:creator[3]/person:person/e:given-name/text()" />
						<layout-element
							ref="pub:publication/e:creator[3]/person:person/e:family-name/text()" />
						<layout-element
							ref="pub:publication/e:creator[3]/organization:organization/dc:title/text()" />
					</elements>
				</layout-element>
				<!-- more then three authors or editors -->
				<layout-element>
					<parameters>
						<valid-if><![CDATA[$creatorsCount>3]]></valid-if>
					</parameters>
					<elements>
						<layout-element ref="$etAll-postfix" />
					</elements>
				</layout-element>
			</elements>
		</layout-element>

		<layout-element name="secondOrMoreSourceCreators">
			<elements>
				<layout-element ref="$sourceCreatorsCount" />
				<!--
					if there are more than 3 source creators write only the first one
				-->
				<layout-element>
					<parameters>
						<valid-if><![CDATA[$sourceCreatorsCount>3]]></valid-if>
					</parameters>
					<elements>
						<layout-element
							ref="pub:publication/source:source/e:creator[1]/person:person/e:given-name/text()" />
						<layout-element
							ref="pub:publication/source:source/e:creator[1]/person:person/e:family-name/text()" />
						<layout-element
							ref="pub:publication/source:source/e:creator[1]/organization:organization/dc:title/text()" />
					</elements>
				</layout-element>
				<!--
					if there are less than 3 source creators write them separate with
					coma
				-->
				<layout-element ref="pub:publication/source:source/e:creator"
					repeatable="yes">
					<parameters>
						<valid-if><![CDATA[$sourceCreatorsCount<4]]></valid-if>
						<delimiter value=", " />
					</parameters>
					<elements>
						<layout-element ref="person:person/e:given-name/text()" />
						<layout-element ref="person:person/e:family-name/text()" />
						<layout-element ref="organization:organization/dc:title/text()" />
					</elements>
				</layout-element>
				<!-- postfix elements -->
				<layout-element>
					<elements>
						<!-- for more then 3 autors write et al. postfix -->
						<layout-element>
							<parameters>
								<valid-if><![CDATA[$sourceCreatorsCount>3]]></valid-if>
							</parameters>
							<elements>
								<layout-element ref="$etAll-postfix" />
							</elements>
						</layout-element>
						<!-- put ed. in bracets -->
						<layout-element>
							<parameters>
								<starts-with value="(" />
								<ends-with value=")" />
							</parameters>
							<elements>
								<!-- if there is one or more than 3 editors, write ed. -->
								<layout-element>
									<parameters>
										<valid-if><![CDATA[$sourceCreatorsCount<2 or $sourceCreatorsCount>3]]></valid-if>
										<i18n ref="editor" />
									</parameters>
									<elements>
										<layout-element ref="$editor-postfix" />
									</elements>
								</layout-element>
								<!-- if there are 2 or 3 editors, write eds. -->
								<layout-element>
									<parameters>
										<valid-if><![CDATA[$sourceCreatorsCount>1 and $sourceCreatorsCount<4]]></valid-if>
										<i18n ref="editors" />
									</parameters>
									<elements>
										<layout-element ref="$editors-postfix" />
									</elements>
								</layout-element>
							</elements>
						</layout-element>
					</elements>
				</layout-element>
			</elements>
		</layout-element>

		<layout-element name="edition">
			<parameters>
				<valid-if><![CDATA[exists(pub:publication/e:publishing-info/e:edition/text()) 
				or exists(pub:publication/source:source[1]/e:publishing-info/e:edition/text())]]></valid-if>
				<starts-with value=", " />
				<delimiter value=". " />
			</parameters>
			<elements>
				<layout-element ref="pub:publication/e:publishing-info/e:edition/text()" />
				<layout-element
					ref="pub:publication/source:source[1]/e:publishing-info/e:edition/text()" />
				<layout-element>
					<parameters>
						<i18n ref="edition" />
					</parameters>
					<elements>
						<layout-element ref="$edition-postfix" />
					</elements>
				</layout-element>
			</elements>
		</layout-element>

		<layout-element name="place-publisher">
			<parameters>
				<starts-with value=", " />
				<delimiter value=", " />
			</parameters>
			<elements>
				<layout-element
					ref="pub:publication/e:publishing-info/dc:publisher/text()" />
				<layout-element ref="pub:publication/e:publishing-info/e:place/text()" />
			</elements>
		</layout-element>

		<!--
			Source Publisher Place for publication like Contr to collected
			edition
		-->
		<layout-element name="source-place-publisher">
			<parameters>
				<starts-with value=", " />
				<delimiter value=", " />
			</parameters>
			<elements>
				<layout-element
					ref="pub:publication/source:source[1]/e:publishing-info/dc:publisher/text()" />
				<layout-element
					ref="pub:publication/source:source[1]/e:publishing-info/e:place/text()" />
			</elements>
		</layout-element>

		<!--
			total nr of pages, used for publications that are existing alone
		-->
		<layout-element name="pages">
			<parameters>
				<valid-if><![CDATA[exists(pub:publication/e:total-number-of-pages/text())]]></valid-if>
				<starts-with value=", " />
			</parameters>
			<elements>
				<layout-element ref="pub:publication/e:total-number-of-pages/text()" />
				<layout-element>
					<parameters>
						<i18n ref="page" />
					</parameters>
					<elements>
						<layout-element ref="$pages-postfix" />
					</elements>
				</layout-element>
			</elements>
		</layout-element>

		<!--
			start and end-page for publications, that are part of another
			publication
		-->
		<layout-element name="start-end-page">
			<parameters>
				<starts-with value=", " />
				<delimiter value=" - " />
			</parameters>
			<elements>
				<layout-element ref="$sourceStartPage" />
				<layout-element>
					<parameters>
						<valid-if><![CDATA[$sourceStartPage < $sourceEndPage]]></valid-if>
					</parameters>
					<elements>
						<layout-element ref="$sourceEndPage" />
					</elements>
				</layout-element>
			</elements>
		</layout-element>

		<!-- Volume-Issue-Year for Journal Article -->
		<layout-element name="volume-issue-year-journal">
			<elements>
				<layout-element>
					<parameters>
						<valid-if><![CDATA[ exists (pub:publication/source:source[1]/e:volume/text()) 
						or exists(pub:publication/source:source[1]/e:issue/text())
						]]></valid-if>
						<delimiter value=", " />
					</parameters>
					<elements>
						<layout-element ref="$firstSourceVolume" />
						<layout-element ref="$firstSourceIssue" />
					</elements>
				</layout-element>

				<layout-element>
					<parameters>
						<valid-if><![CDATA[exists (pub:publication/source:source[1]/e:volume/text()) 
						or exists(pub:publication/source:source[1]/e:issue/text())]]></valid-if>
						<starts-with value="(" />
						<ends-with value=")" />
					</parameters>
					<elements>
						<layout-element ref="$date" />
					</elements>
				</layout-element>
				<layout-element>
					<parameters>
						<valid-if><![CDATA[not(pub:publication/source:source[1]/e:volume/text()) 
						and not(pub:publication/source:source[1]/e:issue/text())]]></valid-if>
					</parameters>
					<elements>
						<layout-element ref="$date" />
					</elements>
				</layout-element>
			</elements>
		</layout-element>

		<!-- Source-Title-Volume for Monograph -->
		<layout-element name="source-title-volume">
			<parameters>
				<valid-if><![CDATA[exists(pub:publication/source:source[1])]]></valid-if>
				<starts-with value="(" />
				<ends-with value=")" />
				<delimiter value=", " />
			</parameters>
			<elements>
				<layout-element ref="pub:publication/source:source[1]/dc:title/text()" />
				<layout-element ref="$firstSourceVolume" />
			</elements>
		</layout-element>

		<!-- Source-Title-Volume for Contribution to collected edition -->
		<layout-element name="source-title-volume-contr">
			<elements>
				<layout-element ref="pub:publication/source:source[1]/dc:title/text()" />
				<layout-element>
					<parameters>
						<valid-if><![CDATA[exists(pub:publication/source:source[2])]]></valid-if>
						<starts-with value="(" />
						<ends-with value=")" />
						<delimiter value=", " />
					</parameters>
					<elements>
						<layout-element ref="pub:publication/source:source[2]/dc:title/text()" />
						<layout-element ref="pub:publication/source:source[2]/e:volume/text()" />
					</elements>
				</layout-element>
				<layout-element>
					<parameters>
						<valid-if><![CDATA[exists(pub:publication/source:source[1]/e:volume/text())]]></valid-if>
						<starts-with value=", " />
					</parameters>
					<elements>
						<layout-element ref="$volum-prefix" />
						<layout-element ref="$firstSourceVolume" />
					</elements>
				</layout-element>

			</elements>
		</layout-element>

		<layout-element name="title">
			<parameters>
				<starts-with value=", " />
			</parameters>
			<elements>
				<layout-element ref="pub:publication/dc:title/text()" />
			</elements>
		</layout-element>

		<layout-element name="source-title">
			<parameters>
				<starts-with value=", " />
			</parameters>
			<elements>
				<layout-element ref="pub:publication/source:source[1]/dc:title/text()" />
			</elements>
		</layout-element>

		<layout-element name="source-abbTitle">
			<parameters>
				<starts-with value=", " />
			</parameters>
			<elements>
				<layout-element
					ref="pub:publication/source:source[1]/dcterms:alternative[@xsi:type='eterms:ABBREVIATION']/text()" />
			</elements>
		</layout-element>

		<layout-element name="test">
			<parameters>
				<delimiter value=", " />
			</parameters>
			<elements>
				<layout-element
					ref="pub:publication/dc:identifier[@xsi:type='eterms:DOI']/text()" />
				<layout-element
					ref="pub:publication/dc:identifier[@xsi:type='eterms:URI']/text()" />
				<layout-element
					ref="pub:publication/source:source[1]/dc:identifier[@xsi:type='eterms:URI']/text()" />
				<layout-element ref="escidocComponents:properties/prop:file-name/text()" />
			</elements>
		</layout-element>

		<layout-element name="legal-case">
			<parameters>
				<starts-with value=", " />
			</parameters>
			<elements>
				<layout-element ref="$genreTitle" />
				<layout-element>
					<parameters>
						<valid-if>
							<![CDATA[not(pub:publication/dc:title/text() = 'Anmerkung zu' or pub:publication/dc:title/text() = 'Besprechung zu')]]>
						</valid-if>
						<starts-with value=", " />
						<ends-with value=", " />
					</parameters>
					<elements>
						<layout-element
							ref="pub:publication/legalCase:legal-case/e:court/text()" />
					</elements>
				</layout-element>
				<layout-element>
					<parameters>
						<valid-if>
							<![CDATA[pub:publication/dc:title/text() = 'Anmerkung zu' or pub:publication/dc:title/text() = 'Besprechung zu']]>
						</valid-if>
						<ends-with value=", " />
					</parameters>
					<elements>
						<layout-element
							ref="pub:publication/legalCase:legal-case/e:court/text()" />
					</elements>
				</layout-element>
				<layout-element
					ref="func:get_reverse_date(pub:publication/legalCase:legal-case/dcterms:issued/text())" />
				<layout-element>
					<parameters>
						<starts-with value=" - " />
					</parameters>
					<elements>
						<layout-element
							ref="pub:publication/legalCase:legal-case/dc:identifier/text()" />
					</elements>
				</layout-element>
				<layout-element
					ref="pub:publication/legalCase:legal-case/dc:title/text()" />
			</elements>
		</layout-element>

		<layout-element name="journal-citation-style">
			<parameters>
				<valid-if><![CDATA[$genre = $l_article or $genre = $l_case-note]]>
			</valid-if>
			</parameters>
			<elements>
				<!--
					Jounral Citation Style: (1) Kurztitel_ZS_Jahr for more info see:
					http://colab.mpdl.mpg.de/mediawiki/JusCMS_Func_Spec_Legal_Citation_Styles_HH_%26_Muc#.281.29_Kurztitel_ZS_Jahr
				-->
				<layout-element>
					<parameters>
						<valid-if><![CDATA[$getCitationStyleForJournal='Kurztitel_ZS_Jahr']]></valid-if>
					</parameters>
					<elements>
						<layout-element ref="$source-abbTitle" />
						<layout-element ref="$date" />
					</elements>
				</layout-element>

				<!--
					Jounral Citation Style: (2) Kurztitel_ZS_Band_Jahr for more info
					see:
					http://colab.mpdl.mpg.de/mediawiki/JusCMS_Func_Spec_Legal_Citation_Styles_HH_%26_Muc#.282.29_Kurztitel_ZS_Band_.28Jahr.29
				-->
				<layout-element>
					<parameters>
						<valid-if><![CDATA[$getCitationStyleForJournal='Kurztitel_ZS_Band_Jahr']]></valid-if>
					</parameters>
					<elements>
						<layout-element ref="$source-abbTitle" />
						<layout-element ref="$firstSourceVolume" />
						<layout-element>
							<parameters>
								<starts-with value="(" />
								<ends-with value=")" />
							</parameters>
							<elements>
								<layout-element ref="$date" />
							</elements>
						</layout-element>
					</elements>
				</layout-element>

				<!--
					Jounral Citation Style: default for more info see:
					http://colab.mpdl.mpg.de/mediawiki/JusCMS_Func_Spec_Legal_Citation_Styles_HH_%26_Muc#Default_citation_style
				-->
				<layout-element>
					<parameters>
						<valid-if><![CDATA[$getCitationStyleForJournal='default']]></valid-if>
					</parameters>
					<elements>
						<layout-element ref="$source-title" />
						<layout-element>
							<parameters>
								<valid-if><![CDATA[$source-title='']]></valid-if>
							</parameters>
							<elements>
								<layout-element ref="$source-abbTitle" />
							</elements>
						</layout-element>
						<layout-element ref="$volume-issue-year-journal" />
					</elements>
				</layout-element>
				<!-- Common journal elements -->
				<layout-element ref="$start-end-page" />
				<layout-element ref="$second-or-more-creators" />
			</elements>
		</layout-element>

	</predefined-layout-elements>

	<!-- Layout definitions of citation styles -->

	<!--
		JOURNAL ARTICLE Sceleton Citation Style
	-->
	<cs-layout-definition name="journal-article-sceleton">
		<parameters>
			<valid-if><![CDATA[$genre = $l_article]]>
			</valid-if>
			<ends-with value="." />
		</parameters>
		<elements>
			<layout-element ref="$first-creator" />
			<layout-element ref="$title" />
			<layout-element ref="$journal-citation-style" />
		</elements>
	</cs-layout-definition>

	<!--
		CONTRIBUTION TO COLLECTED EDITION Citation Style
	-->
	<cs-layout-definition name="contr-to-collected-edition">
		<parameters>
			<valid-if><![CDATA[
				$genre = $l_contr-to-collect-ed
			]]>
			</valid-if>
			<ends-with value="." />
		</parameters>
		<elements>
			<layout-element ref="$first-creator" />
			<layout-element ref="$title" />
			<layout-element ref="$in-prefix" />
			<layout-element ref="$source-title-volume-contr" />
			<layout-element ref="$edition" />
			<layout-element ref="$source-place-publisher" />
			<layout-element ref="$date" />
			<layout-element ref="$start-end-page" />
			<layout-element ref="$second-or-more-creators" />
		</elements>
	</cs-layout-definition>

	<!--
		MONOGRAPH Citation Style
	-->
	<cs-layout-definition name="monograph">
		<parameters>
			<valid-if><![CDATA[
				$genre = $l_monograph
			]]>
			</valid-if>
		</parameters>
		<elements>
			<layout-element ref="$first-creator" />
			<layout-element ref="$title" />
			<layout-element ref="$source-title-volume" />
			<layout-element ref="$edition" />
			<layout-element ref="$place-publisher" />
			<layout-element ref="$date" />
			<layout-element ref="$pages" />
			<layout-element>
				<parameters>
					<valid-if><![CDATA[
					$creatorsCount>1
					]]></valid-if>
					<ends-with value="." />
				</parameters>
				<elements>
					<layout-element ref="$second-or-more-creators" />
				</elements>
			</layout-element>
		</elements>

	</cs-layout-definition>

	<!--
		CASE NOTE Citation Style This publication is part of a journal, a
		reference to a journalCitatonStyle is made.
	-->
	<cs-layout-definition name="caseNote">
		<parameters>
			<valid-if><![CDATA[
				$genre = $l_case-note
			]]>
			</valid-if>
			<ends-with value="." />
		</parameters>
		<elements>
			<layout-element ref="$first-creator" />
			<layout-element ref="$legal-case" />
			<layout-element ref="$journal-citation-style" />
		</elements>
	</cs-layout-definition>

	<!--

		Print warning message for non-publication items <cs-layout-definition
		name="isNotPublication"> <parameters>
		<valid-if><![CDATA[not($hasPublication)]]></valid-if> <starts-with
		value="## Citaion style layout is not defined for metadata record: "
		/> </parameters> <elements> <layout-element ref="$objid" />
		</elements> </cs-layout-definition>
	-->



</citation-style>