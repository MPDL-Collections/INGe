<?xml version="1.0" encoding="UTF-8"?>
	<!--
		CDDL HEADER START The contents of this file are subject to the terms
		of the Common Development and Distribution License, Version 1.0 only
		(the "License"). You may not use this file except in compliance with
		the License. You can obtain a copy of the license at
		license/ESCIDOC.LICENSE or http://www.escidoc.de/license. See the
		License for the specific language governing permissions and
		limitations under the License. When distributing Covered Code, include
		this CDDL HEADER in each file and include the License file at
		license/ESCIDOC.LICENSE. If applicable, add the following below this
		CDDL HEADER, with the fields enclosed by brackets "[]" replaced with
		your own identifying information: Portions Copyright [yyyy] [name of
		copyright owner] CDDL HEADER END Copyright 2006-2007
		Fachinformationszentrum Karlsruhe Gesellschaft für
		wissenschaftlich-technische Information mbH and Max-Planck-
		Gesellschaft zur Förderung der Wissenschaft e.V. All rights reserved.
		Use is subject to license terms.
	-->
<citation-style name="APA" xmlns="http://www.escidoc.de/citationstyle" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.escidoc.de/citationstyle ../../Schemas/citation-style.xsd" read-only="no" element-specific="no" 
	md-xpath="//item/md-records/md-record"> 
	<!-- special variables to be used in expressions for short notations -->
	<variables>
		<!-- variables which use xpath directly in DataSource NS--> 
		<variable name="authorsCount" type="xpath"><![CDATA[string(count(publication/creator[@role='author']))]]></variable> 
		 
		<variable name="editorsCount" type="xpath"><![CDATA[string(count(publication/creator[@role='editor']))]]></variable>
		  
		<variable name="ed-postfix" type="expression"><![CDATA[${toInt}(${editorsCount}) == 1 ? " (Ed.)" : " (Eds.)"]]></variable>

		<variable name="sourceEditorsCount" type="xpath"><![CDATA[string(count(publication/source/creator[@role='editor']))]]></variable>
		  
		<variable name="source-ed-postfix" type="expression"><![CDATA[${toInt}(${sourceEditorsCount}) == 1 ? " (Ed.)" : " (Eds.)"]]></variable>
		
		<variable name="genre" type="xpath"><![CDATA[publication/@type]]></variable>
		
		<variable name="hasPublication" type="xpath"><![CDATA[not(publication)=false()]]></variable>

<!--		<variable name="isBookArticleOrChapter" xpath="not(publication[@type='book-item' or @type='courseware-lecture' or @type='other' or @type='conference-paper' or @type='conference-report'])=false()" />-->
<!--		<variable name="isBookProceedingsThesis" xpath="not(publication[@type='book' or @type='thesis' or @type='proceedings' or @type='journal' or @type='series' or @type='talk-at-event'])=false()" />-->
<!--		<variable name="isJournalOrMagazineArticle" xpath="not(publication[@type='article' or @type='issue' or @type='paper' or @type='book-item' or @type='courseware-lecture' or @type='other' or @type='conference-paper' or @type='conference-report' or @type='book' or @type='thesis' or @type='proceedings' or @type='journal' or @type='series' or @type='talk-at-event'])=false()" />-->

	<!-- Date block -->
<!--		<variable name="date" type="expression">-->
<!--			<![CDATA[${publication/issued} != null ? ${publication/issued} : ${publication/published-online} != null ? ${publication/published-online} : ${publication/dateAccepted} != null ? ${publication/dateAccepted} : ${publication/dateSubmitted} != null ? ${publication/dateSubmitted} : ${publication/modified} != null ? ${publication/modified} : ${publication/created} != null ? ${publication/created} : null]]> -->
<!--		</variable>-->
		
		<variable name="date" type="expression">
			<![CDATA[
				(${publication/@type}.equals("manuscript") && ${publication/created} != null) 
				?
				${get_year}(${publication/created})  
				: 
				${publication/issued} != null
				? 
				${get_year}(${publication/issued}) 
				: 
				${publication/published-online} != null 
				? 
				${get_year}(${publication/published-online}) 
				: 
				${publication/dateAccepted} != null 
				? 
				"in press" 
				: 
				${publication/dateSubmitted} != null 
				? 
				"Submitted for publication" 
				: 
				(${publication/modified}  != null || ${publication/created} != null) 
				? 
				"in preparation" 
				:
				!(${publication/@type}.equals("journal") || ${publication/@type}.equals("series"))
				? 
				"n.d."
				:
				null
			]]>
		</variable>

		
		<!-- doi and url should be revised after fixing of the bug: http://www.escidoc.org/jira/browse/DEV-578  -->
<!--		<variable name="doi" xpath="(publication/identifier[contains(.,'doi')])[1]" />-->
<!--		<variable name="url" xpath="(publication/identifier[contains(.,'http://') or contains(.,'www')])[1]" />-->
		<variable name="doi" type="xpath"><![CDATA[(publication/identifier[@type='DOI'])[1]]]></variable>
		<variable name="url" type="xpath"><![CDATA[(publication/identifier[@type='URI'])[1]]]></variable>
		
	</variables>

	<!-- predefined layout elements which can be referenced in CSLDs -->
	<layout-elements>
		

		<!-- authors -->
		<layout-element name="authors-Equal1" ref="publication/creator[@role='author']" repeatable="yes">
			<parameters>
<!--				<valid-if><![CDATA[${toInt}(${authorsCount})==1]]></valid-if>-->
				<valid-if><![CDATA[${toInt}(${authorsCount})==1]]></valid-if>
				<delimiter value=", " />
				<internal-delimiter value=", " />
			</parameters>
			<elements>
				<layout-element ref="organization/organization-name" />
				<layout-element ref="person/family-name" />
				<layout-element ref="person/given-name" func="get_initials"/>
			</elements>
		</layout-element>
		
		<layout-element name="authors-MoreThan1LessOrEqual6" ref="publication/creator[@role='author']" repeatable="yes">
			<parameters position="last">
				<delimiter value=", &amp; " />
				<internal-delimiter value=", " />
			</parameters>
			<elements position="last">
				<layout-element ref="organization/organization-name" />
				<layout-element ref="person/family-name" />
				<layout-element ref="person/given-name" func="get_initials"/>
			</elements>
			<parameters>
				<valid-if><![CDATA[${toInt}(${authorsCount})>1 && ${toInt}(${authorsCount})<=6]]></valid-if>
				<delimiter value=", " />
				<internal-delimiter value=", " />
			</parameters>
			<elements>
				<layout-element ref="organization/organization-name" />
				<layout-element ref="person/family-name" />
				<layout-element ref="person/given-name" func="get_initials"/>
			</elements>
		</layout-element>
		
		<layout-element name="authors-MoreThan6" ref="publication/creator[@role='author']" repeatable="yes">
			<parameters>
				<valid-if><![CDATA[${toInt}(${authorsCount})>6]]></valid-if>
				<delimiter value=", " />
				<internal-delimiter value=", " />
				<ends-with value=", et al." />
				<max-count value="6"/>
			</parameters>
			<elements>
				<layout-element ref="organization/organization-name" />
				<layout-element ref="person/family-name" />
				<layout-element ref="person/given-name" func="get_initials"/>
			</elements>
		</layout-element>
		
		<layout-element name="authors">
			<parameters>
				<delimiter value="" />
			</parameters>
			<elements>
				<layout-element ref="authors-Equal1" />
				<layout-element ref="authors-MoreThan1LessOrEqual6" />
				<layout-element ref="authors-MoreThan6" />
			</elements>
		</layout-element>

		<!-- editors -->
		<layout-element name="editors-Equal1" ref="publication/creator[@role='editor']" repeatable="yes">
			<parameters>
				<valid-if><![CDATA[${toInt}(${editorsCount})==1]]></valid-if>
				<delimiter value=", " />
				<internal-delimiter value=", " />
			</parameters>
			<elements>
				<layout-element ref="organization/organization-name" />
				<layout-element ref="person/family-name" />
				<layout-element ref="person/given-name" func="get_initials"/>
			</elements>
		</layout-element>
		
		<layout-element name="editors-MoreThan1LessOrEqual6" ref="publication/creator[@role='editor']" repeatable="yes">
			<parameters position="last">
				<delimiter value=", &amp; " />
				<internal-delimiter value=", " />
			</parameters>
			<elements position="last">
				<layout-element ref="organization/organization-name" />
				<layout-element ref="person/family-name" />
				<layout-element ref="person/given-name" func="get_initials"/>
			</elements>
			
			<parameters>
				<valid-if><![CDATA[${toInt}(${editorsCount})>1 && ${toInt}(${editorsCount})<=6]]></valid-if>
				<delimiter value=", " />
				<internal-delimiter value=", " />
			</parameters>
			<elements>
				<layout-element ref="organization/organization-name" />
				<layout-element ref="person/family-name" />
				<layout-element ref="person/given-name" func="get_initials"/>
			</elements>
		</layout-element>
		
		<layout-element name="editors-MoreThan6" ref="publication/creator[@role='editor']" repeatable="yes">
			<parameters>
				<valid-if><![CDATA[${toInt}(${editorsCount})>6]]></valid-if>
				<delimiter value=", " />
				<internal-delimiter value=", " />
				<ends-with value=", et al." /> 
				<max-count value="6"/>
			</parameters>
			<elements>
				<layout-element ref="organization/organization-name" />
				<layout-element ref="person/family-name" />
				<layout-element ref="person/given-name" func="get_initials"/>
			</elements>
		</layout-element>
		
		<layout-element name="editors">
			<parameters>
				<valid-if><![CDATA[${toInt}(${editorsCount})>0 ]]></valid-if>
				<delimiter value="" />
			</parameters>
			<elements>
				<layout-element ref="editors-Equal1" />
				<layout-element ref="editors-MoreThan1LessOrEqual6" />
				<layout-element ref="editors-MoreThan6" />
				<layout-element ref="ed-postfix" />
			</elements>
		</layout-element>

		<layout-element name="editors-with-dot" ref="editors">
			<parameters>
				<ends-with value=". "/>
			</parameters>
			<elements/>
		</layout-element>


		<layout-element name="source-editors-MoreThan2"
			ref="publication/source/creator[@role='editor']"
			repeatable="yes">
			<parameters position="last">
				<delimiter value=", and " />
			</parameters>
			<elements position="last">
				<layout-element ref="organization/organization-name" />
				<layout-element ref="person/family-name" />
				<layout-element ref="person/given-name" func="get_initials"/>
			</elements>
			<parameters>
				<valid-if><![CDATA[${toInt}(${sourceEditorsCount})!=2]]></valid-if>
				<delimiter value=", " />
			</parameters>
			<elements>
				<layout-element ref="organization/organization-name" />
				<layout-element ref="person/family-name" />
				<layout-element ref="person/given-name" func="get_initials"/>
			</elements>
		</layout-element>
		<layout-element name="source-editors-person-Equal2"
			ref="publication/source/creator[@role='editor']/person"
			repeatable="yes">
			<parameters position="last">
				<delimiter value=" and " />
			</parameters>
			<elements position="last">
				<layout-element ref="organization/organization-name" />
				<layout-element ref="person/family-name" />
				<layout-element ref="person/given-name" func="get_initials"/>
			</elements>
			<parameters>
				<valid-if><![CDATA[${toInt}(${sourceEditorsCount})==2]]></valid-if>
				<delimiter value=", " />
			</parameters>
			<elements>
				<layout-element ref="organization/organization-name" />
				<layout-element ref="person/family-name" />
				<layout-element ref="person/given-name" func="get_initials"/>
			</elements>
		</layout-element>
		<layout-element name="source-editors">
			<parameters>
				<valid-if><![CDATA[${toInt}(${sourceEditorsCount})>0]]></valid-if>
				<delimiter value="" />
			</parameters>
			<elements>
				<layout-element ref="source-editors-Equal2" />
				<layout-element ref="source-editors-MoreThan2" />
				<layout-element ref="source-ed-postfix" />
			</elements>
		</layout-element>
		
		
		
		<!-- "plain" layout elements -->
		<!-- ??? -->
<!--		<layout-element name="year" ref="publication/issued" func="get_year">-->

		<layout-element name="year" ref="date">
			<parameters>
				<valid-if><![CDATA[ !${date}.equals("Submitted for publication") ]]></valid-if>
				<font-style ref="DISPLAY_DATE_STATUS"/>
				<starts-with value=" (" />
				<ends-with value="). " />
			</parameters>
			<elements />
		</layout-element>

		<layout-element name="submitted" ref="date">
			<parameters>
				<valid-if><![CDATA[ ${date}.equals("Submitted for publication") ]]></valid-if>
				<starts-with value=" " />
				<ends-with value="." />
			</parameters>
			<elements />
		</layout-element>


		<layout-element name="year" ref="date">
			<parameters>
				<font-style ref="DISPLAY_DATE_STATUS"/>
				<starts-with value=" (" />
				<ends-with value="). " />
			</parameters>
			<elements />
		</layout-element>
		
		<layout-element name="published-online-and-external-locator">
			<parameters>
				<valid-if><![CDATA[${publication/issued}==null && ${publication/published-online}!=null]]></valid-if>
				<starts-with value=". Published online " />
				<delimiter value=". "/>
			</parameters>
			<elements>
				<layout-element ref="publication/published-online" />
				<layout-element ref="doi"/>
				<layout-element>
					<parameters>
						<valid-if><![CDATA[${doi}==null && ${url}!=null]]></valid-if>
						<starts-with value="Retrieved from "/>
						<ends-with value=". "/>
					</parameters>
					<elements>
						<layout-element ref="url"/>
					</elements>
				</layout-element>
			</elements>
		</layout-element>
		



		<layout-element name="year-authors-are-presented">
			<parameters>
				<valid-if><![CDATA[${toInt}(${authorsCount})>0]]></valid-if>
				<ends-with value=". "/>
			</parameters>
			<elements>
				<layout-element ref="year"/>
			</elements>
		</layout-element>
		
		<layout-element name="year-authors-are-not-presented">
			<parameters>
				<valid-if><![CDATA[${toInt}(${authorsCount})==0]]></valid-if>
				<ends-with value=". "/>
			</parameters>
			<elements>
				<layout-element ref="year"/>
			</elements>
		</layout-element>

		<layout-element name="year-and-month-name-issued">
			<parameters>
				<valid-if><![CDATA[${publication/issued}!=null]]></valid-if>
				<delimiter value=", "/>
			</parameters>
			<elements >
				<layout-element ref="publication/issued" func="get_year"/>
				<layout-element ref="publication/issued" func="get_month_name"/>
			</elements>
		</layout-element>

		<layout-element name="year-and-month-name">
			<parameters>
				<font-style ref="DISPLAY_DATE_STATUS"/>
				<starts-with value=" (" />
				<ends-with value="). " />
			</parameters>
			<elements >
				<layout-element ref="year-and-month-name-issued" />
				<layout-element ref="date" >
					<parameters>
						<valid-if><![CDATA[${publication/issued}==null]]></valid-if>
					</parameters>
					<elements/>
				</layout-element>
			</elements>
		</layout-element>

		<layout-element name="year-and-month-authors-are-presented">
			<parameters>
				<valid-if><![CDATA[${toInt}(${authorsCount})>0]]></valid-if>
				<ends-with value=". "/>
			</parameters>
			<elements>
				<layout-element ref="year-and-month-name"/>
			</elements>
		</layout-element>
		
		<layout-element name="year-and-month-authors-are-not-presented">
			<parameters>
				<valid-if><![CDATA[${toInt}(${authorsCount})==0]]></valid-if>
				<ends-with value=". "/>
			</parameters>
			<elements>
				<layout-element ref="year-and-month-name"/>
			</elements>
		</layout-element>

		
		<layout-element name="year-editors-are-presented">
			<parameters>
				<valid-if><![CDATA[${toInt}(${editorsCount})>0]]></valid-if>
				<ends-with value=". "/>
			</parameters>
			<elements>
				<layout-element ref="year"/>
			</elements>
		</layout-element>
		
		<layout-element name="year-editors-are-not-presented">
			<parameters>
				<valid-if><![CDATA[${toInt}(${editorsCount})==0]]></valid-if>
				<ends-with value=". "/>
			</parameters>
			<elements>
				<layout-element ref="year"/>
			</elements>
		</layout-element>
		
		
		<layout-element name="title-with-dot" ref="publication/title">
			<parameters>
				<starts-with value=" " />
				<ends-with value=". " />
			</parameters>
			<elements />
		</layout-element>

		<layout-element name="title-with-dot-italic" ref="title-with-dot">
			<parameters>
				<font-style ref="ITALIC"/>
			</parameters>
			<elements />
		</layout-element>

		
		<layout-element name="start-page-end-page">
			<parameters>
				<delimiter value="-" />
			</parameters>
			<elements>
				<layout-element ref="publication/source/start-page" />
				<layout-element ref="publication/source/end-page" />
			</elements>
		</layout-element>
		
		<layout-element name="volume-issue">
			<parameters>
				<starts-with value=", " />
				<delimiter value="" />
			</parameters>
			<elements>
				<layout-element ref="publication/source/volume">
					<parameters>
						<font-style ref="ITALIC"/>
					</parameters>
					<elements/>
				</layout-element>
				<layout-element ref="publication/source/issue">
					<parameters>
						<starts-with value="("/>
						<ends-with value=")"/>
					</parameters>
					<elements/>
				</layout-element>
			</elements>
		</layout-element>		
		
		<layout-element name="in-press-or-preparation" ref="inPressOrPreparation">
			<parameters>
				<font-style ref="DISPLAY_DATE_STATUS"/>
			</parameters>
			<elements />
		</layout-element>
		
		<layout-element name="in-press-or-preparation-title">
			<parameters>
				<ends-with value=". " />
			</parameters>
			<elements>
				<layout-element ref="in-press-or-preparation"/>
				<layout-element ref="publication/title"/>
			</elements>
		</layout-element>
		
		<layout-element name="source-title" ref="publication/source/title">
			<parameters>
				<font-style ref="ITALIC" />
				<starts-with value=" "/>
			</parameters>
			<elements />
		</layout-element>
		
		<layout-element name="place-publisher">
			<parameters>
				<starts-with value=" " />
				<delimiter value=": " />
			</parameters>
			<elements>
				<layout-element ref="publication/source/publishing-info/place" />
				<layout-element ref="publication/source/publishing-info/publisher" />
			</elements>
		</layout-element>



	<layout-element name="__debugBlock__">
		<parameters>
			<font-style ref="BLUE"/>
			<starts-with value="debug:"/>
			<delimiter value=","/>
		</parameters>
		<elements>
			<layout-element ref="../../@objid" >
				<parameters>
					<starts-with value="OBJID:"/>
				</parameters>
				<elements/>
			</layout-element>
			<layout-element ref="publication/@type" />
			<layout-element ref="publication/title" />
			<layout-element ref="publication/abstract[contains(.,'APA')]"/>
			<layout-element ref="publication/subject" />
			 
<!--			<layout-element ref="isBookArticleOrChapter" /> -->
<!--			<layout-element ref="isBookProceedingsThesis" /> -->
<!--			<layout-element ref="isJournalOrMagazineArticle" /> -->
			<layout-element ref="publication/issued" > 
				<parameters>
					<starts-with value="issued:"/>
				</parameters>
				<elements/>
			</layout-element> 
			<layout-element ref="publication/published-online" > 
				<parameters>
					<starts-with value="published-online:"/>
				</parameters>
				<elements/>
			</layout-element> 
			<layout-element ref="publication/dateAccepted" > 
				<parameters>
					<starts-with value="dateAccepted:"/>
				</parameters>
				<elements/>
			</layout-element>  
			<layout-element ref="publication/dateSubmitted">
				<parameters>
					<starts-with value="dateSubmitted:"/>
				</parameters>
				<elements/>
			</layout-element> 
			<layout-element ref="publication/modified" >
				<parameters>
					<starts-with value="modified:"/>
				</parameters>
				<elements/>
			</layout-element> 
			 
			<layout-element ref="publication/created" >
				<parameters>
					<starts-with value="created:"/>
				</parameters>
				<elements/>
			</layout-element> 
		</elements>
	</layout-element>		
	
	</layout-elements>


    <!-- Print warning message for non-publication items -->
	<cs-layout-definition name="isNotPublication">
		<parameters>
			<valid-if><![CDATA[${hasPublication}.equals("false") ]]></valid-if>
			<starts-with value="## Citaion style layout is not defined for metadata record: " />
<!--			<ends-with value=".\n\n" />-->
		</parameters>
		<elements>
			<layout-element ref="../../@objid" />
		</elements>
		<!-- BOOK CHAPTER -->
		<!--
			Question: Should courseware, other, conference-paper and
			conference-report handled identically?
		-->
		<!--
			Note: We need to differentiate between conference-papers published in
			a book and those published in a journal issue
		-->
	</cs-layout-definition>
	
	<!-- JOURNAL ARTICLE -->
	<cs-layout-definition name="journal-article">
		<parameters>
			<valid-if><![CDATA[${genre}.equals("article")]]></valid-if>
			<delimiter value="" />
			<ends-with value="." />
		</parameters>
		<elements>
			<layout-element ref="debugBlock" />
			
			<layout-element ref="authors" />

			<layout-element ref="year-authors-are-presented"/>
			
			<layout-element ref="title-with-dot"/>

			<layout-element ref="year-authors-are-not-presented"/>
			
			<layout-element ref="source-title"/>
			
			<layout-element>
				<parameters>
					<starts-with value=", "/>
					<delimiter value=", "/>
				</parameters>
				<elements>
					<layout-element ref="volume-issue"/>
					<layout-element ref="start-page-end-page"/>
				</elements>
			</layout-element>
			
			<layout-element ref="published-online-and-external-locator"/>
			
			<layout-element ref="submitted"/>
		
		</elements>
	</cs-layout-definition>
	

	<!-- BOOK, THESIS, PROCEEDINGS -->
	<cs-layout-definition name="book-or-thesis-or-proceedings">
		<parameters>
			<valid-if><![CDATA[${genre}.equals("book") || ${genre}.equals("thesis") || ${genre}.equals("proceedings")]]></valid-if>
			<ends-with value="." />
		</parameters>
		<elements>
			<layout-element ref="debugBlock" />
			
			<layout-element ref="authors"/>
			
			<layout-element name="only-editors">
				<parameters>
					<valid-if><![CDATA[${toInt}(${authorsCount})==0 && ${toInt}(${editorsCount})>0]]></valid-if>
					<ends-with value="."/>
				</parameters>
				<elements>
					<layout-element ref="editors"/>
				</elements>
			</layout-element>
			
			<layout-element name="year-editors-or-authors-are-presented">
				<parameters>
					<valid-if><![CDATA[ ${toInt}(${authorsCount})>0 || ${toInt}(${editorsCount})>0 ]]></valid-if>
				</parameters>
				<elements>
					<layout-element ref="year" />
				</elements>
			</layout-element>
			
			<layout-element ref="publication/title">
				<parameters>
					<ends-with value="." />
					<font-style ref="ITALIC" />
				</parameters>
				<elements />
			</layout-element>
			
			<layout-element name="year-editors-and-authors-are-not-presented">
				<parameters>
					<valid-if><![CDATA[${publication/issued}!=null && (${toInt}(${authorsCount})==0 && ${toInt}(${editorsCount})==0)]]></valid-if>
				</parameters>
				<elements>
					<layout-element ref="year" />
				</elements>
			</layout-element>
			
			<layout-element ref="place-publisher"/>
			
			<layout-element ref="published-online-and-external-locator"/>
			
			<layout-element ref="submitted"/>
		
		</elements>
	</cs-layout-definition>
	
	<!-- BOOK CHAPTER -->
	<cs-layout-definition name="book-item">
		<parameters>
			<valid-if><![CDATA[${genre}.equals("book-item")]]></valid-if>
			<ends-with value="." />
		</parameters>
		<elements>
			<layout-element ref="debugBlock" />
			
			<layout-element ref="authors"/>
			
			<layout-element ref="year-authors-are-presented"/>
			
			<layout-element ref="title-with-dot"/>
			
			<layout-element ref="year-authors-are-not-presented"/>
			
			<layout-element>
				<parameters>
					<starts-with value=" In "/>
					<ends-with value="."/>
				</parameters>
				<elements>
					<layout-element ref="source-editors">
						<parameters>
							<ends-with value=", "/>
						</parameters>
						<elements/>
					</layout-element>
					<layout-element name="book-title">
						<parameters>
							<font-style ref="ITALIC"/>
						</parameters>
						<elements>
							<layout-element ref="publication/source/title"/>
						</elements>
					</layout-element>
					<layout-element>
						<parameters>
							<starts-with value=" (pp. "/>
							<ends-with value=")"/>
						</parameters>
						<elements>
							<layout-element ref="start-page-end-page"/>
						</elements>
					</layout-element>
				</elements>
			</layout-element>
			
			<layout-element ref="place-publisher"/>
			
			<layout-element ref="published-online-and-external-locator"/>
			
			<layout-element ref="submitted"/>
		
		</elements>
	</cs-layout-definition>
	
	<!-- PROCEEDINGS PAPER, SOURCE==JOURNAL -->
	<cs-layout-definition name="proceedings-paper-from-journal">
		<parameters>
			<valid-if><![CDATA[${genre}.equals("conference-paper") && ${publication/source/@type}.equals("journal")]]></valid-if>
			<delimiter value="" />
			<ends-with value="." />
		</parameters>
		<elements>
			<layout-element ref="debugBlock" />
			
			<layout-element ref="authors" />
			
			<layout-element ref="year-authors-are-presented"/>

			<layout-element ref="title-with-dot"/>
			
			<layout-element ref="year-authors-are-not-presented"/>
			
			<layout-element>
				<parameters>
					<font-style ref="ITALIC"/>
					<delimiter value=", "/>
				</parameters>
				<elements>
					<layout-element ref="publication/event/title" />
					<layout-element ref="publication/event/place" />
					<layout-element ref="publication/source/volume" />
				</elements>
			</layout-element>
			
			<layout-element ref="start-page-end-page">
				<parameters>
					<starts-with value=", "/>
				</parameters>
				<elements/>
			</layout-element>
		</elements>
	</cs-layout-definition>	
	
	<!-- PROCEEDINGS PAPER, SOURCE==(BOOK OR PROCEEDINGS) -->
	<cs-layout-definition name="proceedings-paper-from-book-or-proceedings">
		<parameters>
			<valid-if><![CDATA[${genre}.equals("conference-paper") && (${publication/source/@type}.equals("book") || ${publication/source/@type}.equals("proceedings"))]]></valid-if>
			<delimiter value="" />
			<ends-with value="." />
		</parameters>
		<elements>
			<layout-element ref="debugBlock" />
			
			<layout-element ref="authors" />
			
			<layout-element ref="year-authors-are-presented"/>

			<layout-element ref="title-with-dot"/>
			
			<layout-element ref="year-authors-are-not-presented"/>
			
			<layout-element ref="source-editors">
				<parameters>
					<starts-with value=" In "/>
					<ends-with value=","/>
				</parameters>
				<elements/>
			</layout-element>
			
			<layout-element>
				<parameters>
					<font-style ref="ITALIC"/>
					<delimiter value=". "/>
					<starts-with value=" "/>
				</parameters>
				<elements>
					<layout-element ref="publication/event/title" />
					<layout-element ref="publication/source/volume">
						<parameters>
							<starts-with value="Vol. "/>
						</parameters>
						<elements/>
					</layout-element>
					<layout-element ref="publication/source/title" />
				</elements>
			</layout-element>

			<layout-element ref="start-page-end-page">
				<parameters>
					<starts-with value=" (pp. "/>
					<ends-with value=")."/>
				</parameters>
				<elements/>
			</layout-element>
			
			<layout-element ref="place-publisher"/>
			
			<layout-element ref="submitted"/>
			
		</elements>
	
	</cs-layout-definition>	
	
	<!-- ISSUE -->
	<cs-layout-definition name="issue">
		<parameters>
			<valid-if><![CDATA[${genre}.equals("issue")]]></valid-if>
			<delimiter value="" />
			<ends-with value="." />
		</parameters>
		<elements>
			<layout-element ref="debugBlock" />
			
			<layout-element ref="editors-with-dot" />

			<layout-element ref="year-editors-are-presented"/>
			
			<layout-element>
				<parameters>
					<starts-with value=" "/>
					<ends-with value=" [Special Issue]." />
				</parameters>
				<elements>
					<layout-element ref="publication/title"/>
				</elements>
			</layout-element>
			
			<layout-element ref="year-editors-are-not-presented"/>
			
			<layout-element ref="source-title" />
			
			<layout-element ref="volume-issue"/>
			
			<layout-element ref="submitted"/>
			
		</elements>
	
	</cs-layout-definition>
	

	<!-- experimental -->
	<!-- JOURNAL -->
	<cs-layout-definition name="journal">
		<parameters>
			<valid-if><![CDATA[${genre}.equals("journal")]]></valid-if>
			<delimiter value="" />
			<ends-with value="." />
		</parameters>
		<elements>
			<layout-element ref="debugBlock" />
			
			<layout-element ref="editors-with-dot"/> 
			
			<layout-element ref="year-editors-are-presented"/>
			
			<layout-element ref="title-with-dot-italic"/>

			<layout-element ref="year-editors-are-not-presented"/>
			
			<layout-element ref="source-title" />
			
			<layout-element ref="place-publisher"/>
			
			<layout-element ref="submitted"/>
			
		</elements>
	
	</cs-layout-definition>
	
	<!-- UNPUBLISHED MANUSCRIPT -->
	<cs-layout-definition name="manuscript">
		<parameters>
			<valid-if><![CDATA[${genre}.equals("manuscript")]]></valid-if>
			<delimiter value="" />
			<ends-with value=". Unpublished Manuscript." />
		</parameters>
		<elements>
			<layout-element ref="debugBlock" />
			
			<layout-element ref="authors"/>
			
			<layout-element ref="year-authors-are-presented"/>
			
			<layout-element ref="title-with-dot-italic"/>

			<layout-element ref="year-authors-are-not-presented"/>
			
			<layout-element ref="source-title" />
			
			<layout-element ref="place-publisher"/>
			
			<layout-element ref="submitted"/>
		</elements>
	
	</cs-layout-definition>	
	
	<!-- SERIES -->
	<cs-layout-definition name="series">
		<parameters>
			<valid-if><![CDATA[${genre}.equals("series")]]></valid-if>
			<delimiter value="" />
			<ends-with value="." />
		</parameters>
		<elements>
			<layout-element ref="debugBlock" />

			<layout-element ref="editors-with-dot"/>

			<layout-element ref="year-editors-are-presented"/>
			
			<layout-element ref="publication/title">
				<parameters>
					<font-style ref="ITALIC"/>
					<starts-with value=" "/>
					<ends-with value="."/>
				</parameters>
				<elements/>
			</layout-element>
			
			<layout-element ref="year-editors-are-not-presented"/>
			
			<!-- start-volume / end-volume are not presented in MD, only volume!!! -->
			<layout-element name="volumes">
				<parameters>
					<starts-with value=" (Vols. "/>
					<ends-with value=")."/>
				</parameters>
				<elements>
					<layout-element ref="publication/source/volume"/>
				</elements>
			</layout-element>
			
			<layout-element ref="place-publisher"/>
			
			<layout-element ref="submitted"/>
			
		</elements>
	
	</cs-layout-definition>
	
	<!-- TALK-AT-EVENT, PAPER -->
	<cs-layout-definition name="talk-at-event-or-or-paper">
		<parameters>
			<valid-if><![CDATA[
					${genre}.equals("talk-at-event")
				||	${genre}.equals("paper")
				]]></valid-if>
			<delimiter value="" />
			<ends-with value="." />
		</parameters>
		<elements>
			<layout-element ref="debugBlock" />
			
			<layout-element ref="authors"/>

			<layout-element ref="year-authors-are-presented"/>
			
			<layout-element ref="title-with-dot"/>
			
			<layout-element ref="year-authors-are-not-presented"/>

			<layout-element name="event-title">
				<parameters>
					<starts-with value=" "/>
					<ends-with value="."/>
					<font-style ref="ITALIC"/>
				</parameters>
				<elements>
					<layout-element ref="publication/event/title"/>
				</elements>
			</layout-element>
			
			<layout-element name="event-place">
				<parameters>
					<starts-with value=" "/>
				</parameters>
				<elements>
					<layout-element ref="publication/event/place"/>
				</elements>
			</layout-element>
			
			<layout-element ref="submitted"/>

		</elements>
	
	</cs-layout-definition>
	
	<!-- POSTER  -->
	<cs-layout-definition name="poster">
		<parameters>
			<valid-if><![CDATA[${genre}.equals("poster")]]></valid-if>
			<delimiter value="" />
			<ends-with value="." />
		</parameters>
		<elements>
			<layout-element ref="debugBlock" />
			
			<layout-element ref="authors"/>

			<layout-element ref="year-and-month-authors-are-presented"/>
			
			<layout-element ref="title-with-dot-italic"/>
			
			<layout-element ref="year-and-month-authors-are-not-presented"/>

			<layout-element name="event-title-and-place">
				<parameters>
					<valid-if><![CDATA[${publication/event/title}!=null]]></valid-if>
					<starts-with value=" Poster presented at "/>
					<delimiter value=", "/>
				</parameters>
				<elements>
					<layout-element ref="publication/event/title"/>
					<layout-element ref="publication/event/place"/>
				</elements>
			</layout-element>
			
			<layout-element ref="submitted"/>

		</elements>
	
	</cs-layout-definition>
	
	
	<!-- REPORT -->
	<cs-layout-definition name="report">
		<parameters>
			<valid-if><![CDATA[${genre}.equals("report")]]></valid-if>
			<delimiter value="" />
			<ends-with value="." />
		</parameters>
		<elements>
			<layout-element ref="debugBlock" />
			
			<layout-element ref="authors"/>

			<layout-element ref="year-authors-are-presented"/>
			
			<layout-element name="title-report-identifier">
				<parameters>
					<starts-with value=" "/>
					<ends-with value="."/>
					<delimiter value=" "/>
				</parameters>
				<elements>
					<layout-element ref="title-with-dot">
						<parameters>
							<font-style ref="ITALIC"/>
						</parameters>
						<elements/>
					</layout-element>
					<!-- report identifier ?????? -->
					<layout-element ref="(publication/identifier)[1]">
						<parameters>
							<starts-with value="("/>
							<ends-with value=")"/>
						</parameters>
						<elements/>
					</layout-element>
				</elements>
			</layout-element>
			
			<layout-element ref="year-authors-are-not-presented"/>

			<layout-element ref="place-publisher"/>
			
			<layout-element ref="submitted"/>
			
		</elements>
	
	</cs-layout-definition>
	
<!--	Test CSLD: -->
<!--	<cs-layout-definition name="notMatched">-->
<!--		<parameters>-->
<!--			<valid-if><![CDATA[${hasPublication}.equals("true")]]></valid-if>-->
<!--		</parameters>-->
<!--		<elements>-->
<!--			--> 
<!--			<layout-element ref="debugBlock" />-->
<!--		-->
<!--		</elements>-->
<!--	</cs-layout-definition>-->

</citation-style>