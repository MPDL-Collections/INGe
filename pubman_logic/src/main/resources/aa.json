{
	"de.mpg.mpdl.inge.service.pubman.impl.PubItemServiceDbImpl" : {
		"technical" : {
			"order" : ["user", "item", "context"],
			"indices" : {
				"item.owner.objectId" : "owner.objectId",
				"item.context.objectId" : "context.objectId",
				"item.version.state" : "version.state",
				"item.publicStatus" : "publicStatus"
			}
		}, 
		"create" : [
			{
				"user" : {
					"role" : "DEPOSITOR",
					"grant_type" : "CONTEXT",
					"field_grant_id_match" : "item.context.objectId"
				}
			}
		],
		
		"update" : [
			{
				"user" : {
					"field_user_id_match" : "item.owner.objectId"
				},
				"context.adminDescriptor.workflow" : "SIMPLE",
				"item.version.state" : ["PENDING", "RELEASED"],
				"item.publicStatus" : ["PENDING", "SUBMITTED", "RELEASED"]
			},
			{
				"context.adminDescriptor.workflow" : "SIMPLE",
				"user" : {
					"role" : "MODERATOR",
					"grant_type" : "CONTEXT",
					"field_grant_id_match" : "item.context.objectId"
				},
				"item.version.state" : ["RELEASED"],
				"item.publicStatus" : ["PENDING", "SUBMITTED", "RELEASED"]
			},
			{
				"context.adminDescriptor.workflow" : "STANDARD",
				"user" : {
					"field_user_id_match" : "item.owner.objectId"
				},
				"item.version.state" : ["PENDING", "RELEASED", "IN_REVISION"],
				"item.publicStatus" : ["PENDING", "SUBMITTED", "RELEASED"]
			},
			{
				"context.adminDescriptor.workflow" : "STANDARD",
				"user" : {
					"role" : "MODERATOR",
					"grant_type" : "CONTEXT",
					"field_grant_id_match" : "item.context.objectId"
				},
				"item.version.state" : ["RELEASED", "SUBMITTED"],
				"item.publicStatus" : ["PENDING", "SUBMITTED", "RELEASED"]
			}
		],
		
		"delete" : [
			{
				"user" : {
					"field_user_id_match" : "item.owner.objectId"
				},
				"item.version.state" : ["PENDING", "IN_REVISION"],
				"item.publicStatus" : ["PENDING", "SUBMITTED"]
			}
		],
		
		"get" : [
			{
				"item.version.state" : ["RELEASED"]
			},
			{
				"item.publicStatus" : ["WITHDRAWN"]
			},
			{
				"user" : {
					"field_user_id_match" : "item.owner.objectId"
				},
				"item.version.state" : ["PENDING", "IN_REVISION", "SUBMITTED"]
			},
			{
				"user" : {
					"role" : "MODERATOR",
					"grant_type" : "CONTEXT",
					"field_grant_id_match" : "item.context.objectId"
				},
				"item.version.state" : ["SUBMITTED", "IN_REVISION"]
			}
		],
		
		"submit" : [
			{
				"context.adminDescriptor.workflow" : "STANDARD",
				"user" : {
					"field_user_id_match" : "item.owner.objectId"
				},
				"item.version.state" : ["PENDING", "IN_REVISION"],
				"item.publicStatus" : ["PENDING", "SUBMITTED", "RELEASED"]
			}
		],
		
		"release" : [
			{
				"context.adminDescriptor.workflow" : "SIMPLE",
				"user" : {
					"field_user_id_match" : "item.owner.objectId"
				},
				"item.version.state" : ["PENDING", "SUBMITTED"],
				"item.publicStatus" : ["PENDING", "SUBMITTED", "RELEASED"]
			},
			{
				"context.adminDescriptor.workflow" : "STANDARD",
				"user" : {
					"role" : "MODERATOR",
					"grant_type" : "CONTEXT",
					"field_grant_id_match" : "item.context.objectId"
				},
				"item.version.state" : ["SUBMITTED"],
				"item.publicStatus" : ["PENDING", "SUBMITTED", "RELEASED"]
			}
		],
		
		"revise" : [
			{
				"context.adminDescriptor.workflow" : "STANDARD",
				"user" : {
					"role" : "MODERATOR",
					"grant_type" : "CONTEXT",
					"field_grant_id_match" : "item.context.objectId"
				},
				"item.version.state" : ["SUBMITTED"],
				"item.publicStatus" : ["PENDING", "SUBMITTED", "RELEASED"]
			}
		],
		
		"withdraw" : [
			{
				"context.adminDescriptor.workflow" : "SIMPLE",
				"user" : {
					"field_user_id_match" : "item.owner.objectId"
				},
				"item.version.state" : ["RELEASED"],
				"item.publicStatus" : ["RELEASED"]
			},
			{
				"context.adminDescriptor.workflow" : "STANDARD",
				"user" : {
					"role" : "MODERATOR",
					"grant_type" : "CONTEXT",
					"field_grant_id_match" : "item.context.objectId"
				},
				"item.version.state" : ["RELEASED"],
				"item.publicStatus" : ["RELEASED"]
			}
		]
	},
	"de.mpg.mpdl.inge.service.pubman.impl.OrganizationServiceDbImpl" : {
		"technical" : {
			"order" : ["user", "ou"],
			"indices" : {
			}
		}, 
		"create" : [
			{
				"user" : {
					"role" : "SYSADMIN"
				}
			}
		],
		
		"update" : [
			{
				"user" : {
					"role" : "SYSADMIN"
				}
			}
		],
		
		"delete" : [
			{
				"user" : {
					"role" : "SYSADMIN"
				},
				"ou.hasChildren" : "false",
				"context.state" : "CREATED"
				
			}
		],
		
		"get" : [

		],
		
		"open" : [
			{
				"user" : {
					"role" : "SYSADMIN"
				},
				"context.state" : "CREATED"
			}
		],
		"close" : [
			{
				"user" : {
					"role" : "SYSADMIN"
				},
				"context.state" : "OPENED"
			}
		]
	},
	"de.mpg.mpdl.inge.service.pubman.impl.ContextServiceDbImpl" : {
		"technical" : {
			"order" : [ "user", "context"],
			"indices" : {
			}
		}, 
		"create" : [
			{
				"user" : {
					"role" : "SYSADMIN"
				}
			}
		],
		
		"update" : [
			{
				"user" : {
					"role" : "SYSADMIN"
				}
			}
		],
		
		"delete" : [
			{
				"user" : {
					"role" : "SYSADMIN"
				},
				"context.state" : "CREATED"
				
			}
		],
		
		"get" : [

		],
		
		"open" : [
			{
				"user" : {
					"role" : "SYSADMIN"
				},
				"context.state" : "CREATED"
			}
		],
		"close" : [
			{
				"user" : {
					"role" : "SYSADMIN"
				},
				"context.state" : "OPENED"
			}
		]
	},
	"de.mpg.mpdl.inge.service.pubman.impl.UserAccountServiceImpl" : {
		"technical" : {
			"order" : ["user", "givenUser"],
			"indices" : {
			}
		}, 
		"create" : [
			{
				"user" : {
					"role" : "SYSADMIN"
				}
			}
		],
		
		"update" : [
			{
				"user" : {
					"role" : "SYSADMIN"
				}
			}
		],
		
		"delete" : [
			{
				"user" : {
					"role" : "SYSADMIN"
				}
			}
		],
		
		"get" : [
			{
				"user" : {
					"role" : "SYSADMIN"
				}
			},
			{
				"user.reference.objectId": "givenUser.reference.objectId"

			}
		],
		
		"addGrants" : [
			{
				"user" : {
					"role" : "SYSADMIN"
				}
			}
		],
		"removeGrants" : [
			{
				"user" : {
					"role" : "SYSADMIN"
				}
			}
		]
	}
}